= Anypoint Exchange 1 (旧バージョン)
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:keywords: Exchange, コンテンツタイプ

[NOTE]
このページでは、レガシー製品の Exchange 1 について説明します。すべてのユーザが現在のバージョンの xref:index.adoc[Exchange 2] にxref:migrate.adoc[移行]することをお勧めします。

Exchange 1 には、コネクタ、テンプレート、サンプル、API、その他の学習情報を含む完全なリストがあります。クラウドまたはオンプレミスで使用できます。社内のベストプラクティスのコラボレーションと共有を行うため、Anypoint Exchange の非公開テナントにアセットを追加できます。

== Anypoint Exchange にアクセスする

. `+https://anypoint.mulesoft.com/exchange1/+` で Exchange 1 にアクセスします。
. Studio 内の Anypoint Studio タスクバーから、Anypoint Studio の Exchange 1 にアクセスできるようにするには、[Preferences (プリファレンス)] > [Anypoint Studio] > [Exchange] をクリックし、[Exchange Settings URL (Exchange 設定 URL)] の値を `+https://anypoint.mulesoft.com/exchange1/+` に設定します。
. 上部タスクバーの Exchange ツールバーアイコンをクリックします。
+
image::ex1-exchange-studio-symbol.png[スクリーンショット - Studio タスクバーの Exchange アイコン]
+
. Studio 内の Anypoint Studio の [Mule Palette (Mule パレット)] から検索すると、
Exchange の追加情報へのリンクが表示されます。
+
image::ex1-exchange-search-access.png[スクリーンショット - Studio の検索での Exchange へのアクセス]
+
. [Studio Project (Studio プロジェクト)] メニューから、[File (ファイル)] > [New (新規)] > [Project From Template (テンプレートからプロジェクト)] をクリックし、テンプレートから Mule プロジェクトを作成します。

== Anypoint Exchange 機能

Anypoint Exchange には、次のような接続と API アセットを検出して使用するための統一されたユーザインターフェースおよび API が備えられています。

* Examples (サンプル) - Anypoint Studio 内の開発要素、および特定の API とインテグレーションの目的を達成するためにそれらをどのように活用できるかを説明する実装プロジェクト。たとえば、実行する準備が整っていてユースケースまたはソリューションを実証するアプリケーションなど。
* Templates (テンプレート) - 一般的なユースケースに対応し、ベストプラクティスに基づいて構築されパッケージ化されたインテグレーションパターン。情報を追加してユーザのケースまたはソリューションを完了する、ユースケースアプリケーション。
* Connectors (コネクタ) - サードパーティの API と標準のインテグレーションプロトコルを使用して MuleSoft の Anypoint Platform で開発およびデプロイされた、エンドポイントに対するパッケージ化された接続。Anypoint Studio には多数のコネクタが事前に読み込まれますが、Exchange にはコネクタの完全なリストがあります。リソース間の接続を提供するアプリケーションに関する詳細が表示されます。コネクタをインストールするには、Anypoint Studio 内から Exchange を開きます。
* REST API - RAML API 記述 (`+raml.org+` を参照)。OAS REST API がある場合は、Exchange 2 を使用してインストールします。
* SOAP API - Anypoint Platform をよりすばやく簡単に採用するために役立つ WSDL の API 記述。
* Others (その他) - ブログ、記事、動画など。DataWeave の情報、MEL、バッチ処理、MUnit、ポリシー、ナレッジ共有情報ソースへのリンクなど、ナレッジ共有に役立つリンク。

Exchange には、非公開アセットのカタログと検出に加えて、MuleSoft によって提供される公開アセットを検出する機能があります。  すべての公開コンテンツは MuleSoft によって提供および認定され、パートナーコネクタは MuleSoft によってレビューおよび承認されています。  すべての非公開コンテンツは組織の内部にあり、外部には公開されません。  お客様は、独自の Exchange 内でパブリッシュされた非公開コンテンツに対して責任を負います。

Exchange を使用して次のことができます。

* 重要な情報にあふれたカテゴリを作成することで、生産性を向上させ、新規ユーザの参加を促進する。
* 組織の標準、ポリシー、またはガイドラインに準拠し、エラー処理、監査、認証などのタスクの実行方法が一貫して採用されていることを確認する。
* ベストプラクティスを共有し、それに基づいて構築する。  ユーザは、Exchange を検索または参照することでベストプラクティスを採用し、既存のアセットに対する理解を深めながら、機能強化を提案できます。

Anypoint Exchange Private Cloud Edition では、企業が自社のサイトから Exchange を管理できます。
詳細は、「Anypoint Exchange Private Cloud Edition リリースノート」を参照してください。

Anypoint Exchange Private Cloud Edition はクラウドで使用可能な MuleSoft テナントへのアクセスをユーザに許可していないため、デフォルトのコンテンツなしで出荷されます。

Exchange Private Cloud Edition は現在、Anypoint Studio からはアクセスできません。

== Anypoint Exchange のナビゲーション

Exchange は、名前のタグとキーワード、概要、説明、および項目のタグを使用して検索できます。各要素には、バージョン、サポートしている Mule Runtime バージョンなどを参照するラベルのタグが付けられます。これらはパターン別に整理されるため、関心がある内容を実行する要素のみをスキャンできます。

各項目で次のことができます。

* [View Details (詳細を表示)] をクリックし、プロジェクトの簡単な概要を参照してその他のオプションにアクセスする。
* [Download (ダウンロード)]をクリックし、プロジェクトまたはコネクタを直接 Studio ワークスペースにダウンロードして Studio で開く。

すべてのコンテンツには、そのタイプに関係なく関連付けられた評価があります。この評価は、要素が 2 つ以上の評価を受け取った後に要素の横に表示されます。

Anypoint Studio から Exchange にアクセスした場合にのみ、評価を送信できます。コネクタを評価する場合、そのコネクタを Anypoint Studio にインストールしている必要もあります。

== コンテンツタイプ

Exchange の公開コンテンツと非公開コンテンツは両方とも、次のタイプの要素で構成できます。

Connectors (コネクタ) - Mule アプリケーションとサードパーティの API および標準のインテグレーションプロトコルを簡単に統合できるようにします。アプリケーションのフロー内でこれらを使用して、プロトコルまたは特定の API を介してデータを送受信します。Anypoint Studio には多数のコネクタがバンドルされていますが、Exchange にはさらに多くのコネクタがあります。

REST および SOAP ファイル - API は、API の構造を記述する RAML ファイルであり、メタデータを Studio に公開するために HTTP 要求コネクタで参照できます。

Examples (サンプル) - Studio の要素と、それらが特定の目的を達成するためにどのように連携するかを説明する Mule プロジェクト。

テンプレートは、一般的なエンタープライズインテグレーションのユースケースを対象とするプロジェクトです。必要なことを実行できるテンプレートを見つけてユーザログイン情報を指定すれば、デプロイする準備は完了です。必要に応じて、テンプレートをカスタマイズまたは拡張することもできます。

Exchange のすべてのテンプレートは、次のデータインテグレーションパターンに基づいています。

* 移行
* ブロードキャスト
* 双方向同期
* 相関関係
* 集約

サンプルとテンプレートのカテゴリは、各プロジェクトの構築目的によって異なります。テンプレートでは最小限の作業でソリューションをほぼすぐに使用できますが、サンプルは Studio 要素の理解を深めて独自のソリューションを構築するためにあります。もちろん、必要に応じて、実際のデプロイ可能なプロジェクトの開始点としてサンプルを使用したり、概念を理解するためのツールとしてテンプレートを使用したりすることもできます。

== Anypoint Exchange の管理

ユーザが組織の Exchange から要素を作成、パブリッシュ、更新、または削除するには、最初に適切な権限を付与されている必要があります。デフォルトでは、組織のシステム管理者も含むすべてのユーザは、項目を送信または編集する権限がありません。

Anypoint Platform には、Exchange のコンテンツを管理またはコントリビュートできるユーザを定義する次のロールが用意されています。

* Exchange コントリビュータ - ユーザは独自の項目を追加および編集可能。ただし、作成されたコンテンツは Exchange 管理者がパブリッシュ済みに設定するまでパブリッシュされず、作成者と管理者のみに表示されます。コントリビュータはパブリッシュされた他のユーザのすべてのコンテンツを参照できますが、編集または削除することはできません。
* Exchange 管理者 - ユーザはすべての項目を追加、編集、パブリッシュ、削除可能。Exchange 管理者は組織の内部コンテンツの管理者の役割を果たし、Exchange にパブリッシュされていない独自のコンテンツや他のユーザのコンテンツをパブリッシュできます。パブリッシュされたら、コンテンツは組織内の全員に表示されます。パブリッシュされているかどうかにかかわらず、他のユーザのコンテンツを参照、編集、または削除できます。
* 組織のシステム管理者 - 標準の Anypoint Platform ユーザインターフェースを介して Exchange 固有のロールを管理。

== Anypoint Exchange へのコントリビュート

ユーザが組織の Exchange に項目をコントリビュートするには、Anypoint Platform にサインアップしてログインし、Exchange コントリビュータまたは Exchange 管理者ロールが割り当てられている必要があります。

MuleSoft により事前に読み込まれた Anypoint Exchange のすべてのコンテンツは参照のみです。

組織の Exchange でエントリを作成する資格があるユーザには、Exchange の左上に [Add Item (項目を追加)] ボタンが表示されます。
ユーザは項目を送信するときに、ドロップダウンリストから項目種別を選択する必要があります。項目種別は、項目送信フォームに表示される項目を表します。選択されたコンテンツタイプに関係なく、項目の説明に多数の標準メタデータ項目を使用できます。

* Name (名前): 表示される項目の名前(必須)。
* Item ID (項目 ID): URI (リソースの名前を識別するために使用される文字列)。これにより、項目を独自のエンティティとして独自の URL と内部で共有できます(必須)。
* Icon URL (アイコン URL): Web でホストされる画像の URL(省略可能)。
* Summary (概要): 項目の見出しの概要(省略可能)。
* Author (作成者): 項目の作成者とその作成者/チームの画像。これは、組織に多数のコントリビュータとパートナーがいる場合に役立ちます(省略可能)。
* Description (説明): 項目の詳細な説明。このセクションを編集するには、マークダウンまたは HTML を使用します。
* YouTube Video URL (Youtube 動画 URL): 項目に関する詳細情報を提供する YouTube 動画。これは、サンプルまたはテンプレートやコネクタの利用方法を説明する場合に特に役立ちます。
* Versions (バージョン): MuleSoft で項目を Exchange に追加するときに必要なバージョン情報。これにより、ユーザは Exchange が時間の経過に伴って開発され成熟したときに、Exchange 内でアセットの特定のバージョンを識別および検索できます。
* File URL or Link (ファイルの URL またはリンク): 項目の特定のバージョンを構成する物理的アセットへの参照。
* Version (バージョン): 項目のバージョン。
* Runtime (ランタイム): アセットがサポートされている Mule Runtime バージョン。
* Documentation URL (ドキュメント URL): バージョン管理されたアセットに関する詳細ドキュメント (開発者向けリファレンスドキュメントなど) への参照。
* Tags (タグ): 項目を説明し、Exchange で簡単に検出および検索するために役立つメタデータタグ。
* Links (リンク): 追加リソースや関連リソースへのリンク。
項目が送信されるときに、項目は未パブリッシュの状態で Exchange に追加されます。  未パブリッシュの項目は、作成者と Exchange 管理者にのみ表示されます。Exchange 管理者は項目のパブリッシュを担当します。項目のレビュー後、管理者はボタンをクリックするだけで項目をパブリッシュしてライブ状態にできます。  同様に、Exchange 管理者は項目のパブリッシュを解除できます。

=== アセットの保存

Anypoint Exchange は、組織のアセットの保存もホストも行いません。  Exchange はアセットを検出してコンシュームするためのプラットフォーム全体のインターフェースを提供しますが、アセットは外部のリポジトリに保存する必要があります。

通常、アセット自体は次のような既存の組織のリポジトリに保存されます。

* ソースコードリポジトリ。
* アーティファクトリポジトリ。
* コンテンツ管理システム (CMS)。
* API ポータル。
* Web サイトなどの他のインターネットベースのリソース。

== アセットのコンシューム

Anypoint Studio では、Exchange 内の項目に移動して、アセットを開いたりインストール (または Web サイトやポータルからダウンロード) できます。


== Anypoint Exchange からのコネクタのインストール

コネクタをインストールするには、最初に Anypoint Studio を起動し、Studio タスクバーの左側にある Exchange アイコンをクリックする必要があります。ブラウザで開いた Anypoint Exchange では、コネクタの詳細の参照のみ可能で、インストールはできません。コネクタがコンピュータにすでにインストールされている場合、(Sudio 経由でアクセスした) Exchange の [Installed (インストール済み)] ボタンはグレー表示されます。

Exchange から Studio にコネクタをインストールする手順は、次のとおりです。

. Anypoint Studio で Exchange 1 へのアクセスを有効にするため、Preferences (プリファレンス) > [Anypoint Studio] > [Exchange] をクリックし、[Exchange
Settings URL (Exchange 設定 URL)] の値を `+https://anypoint.mulesoft.com/exchange1/+` に設定します。
. 必要なコネクタを検索します。[View Details (詳細を表示)] をクリックし、プロジェクトを構築する Mule Runtime とコネクタは互換性があることを確認します。コネクタに互換性がある場合、[Install (インストール)] をクリックします。
. 契約条件に同意してウィザードの指示に従い、Studio を再起動します。
. コネクタを検索し、Studio キャンバスにドラッグします。

== Exchange でのサンプルの実装

. Anypoint Studio で Exchange 1 へのアクセスを有効にするため、Preferences (プリファレンス) > [Anypoint Studio] > [Exchange] をクリックし、[Exchange
Settings URL (Exchange 設定 URL)] の値を `+https://anypoint.mulesoft.com/exchange1/+` に設定します。
. ニーズに最適なサンプルを見つけて、[View details (詳細を表示)] をクリックします。
. [Open in Studio (Studio で開く)] をクリックし、新規プロジェクトとして Studio にインポートします。
. Package Explorer でプロジェクトが使用可能になります。それに含まれるファイルを調べます。`src/main/app` を確認し、このサンプルの XML ファイルを見つけます。
. プロジェクト内にユーザログイン情報を必要とするコネクタがある場合は、コネクタのプロパティエディタを開き、項目に入力します。
. サンプルはこれで完成です。デプロイしてその結果を参照したり、デバッグモードで実行して各ステップで Mule メッセージがどうなるかを調べたり、必要に応じて修正したりできます。

== Exchange からのテンプレートの実装

Exchange でテンプレートを実装するための基本的な手順は、次のとおりです。

. Anypoint Studio で Exchange 1 へのアクセスを有効にするため、Preferences (プリファレンス) > [Anypoint Studio] > [Exchange] をクリックし、[Exchange
Settings URL (Exchange 設定 URL)] の値を `+https://anypoint.mulesoft.com/exchange1/+` に設定します。
. ニーズに最適なテンプレートを見つけて、[Open in Studio (Studio で開く)] をクリックします。
. Package Explorer でこのプロジェクトが使用可能になります。それに含まれるファイルを調べます。プロジェクトを最初に開いたときにエラーのマークが表示される可能性がありますが、これは使用されているコネクタが機能するにはユーザログイン情報が設定されている必要があることを示しているだけです。
. `dev` 以外の環境にアプリケーションをデプロイする場合は、プロジェクトフォルダのルートレベルにある `mule-project.xml` ファイルを開き、`mule.env` パラメータの値を変更します。
+
image::ex1-mule-env.png[Mule プロジェクトの概要のスクリーンショット]
+
. Exchange のすべてのテンプレートはすでに組み込まれているため、機能させるために必要な作業は設定ファイルにログイン情報を含めることのみです。プロジェクトのフロー内のすべてのコネクタとグローバル要素はこれらの設定ファイルの項目を参照するため、テンプレートのしくみを拡張またはカスタマイズする予定がない限り、これらのファイル以外のものを変更したり調べたりする必要はありません。これらのファイルは `src/main/resources` フォルダ内にあります。前のステップでデプロイ用に選択した環境に対応するファイルを見つけて、それを開きます。
. 設定ファイルで必須の各項目の値を指定します。これには、ユーザログイン情報、ポート番号、コールバック URL などがあります。
. アプリケーションをテストするには、緑の <b>[`Run`</b> (実行)] ボタンの横にあるドロップダウンメニューをクリックしてリストからプロジェクトを選択し、プロジェクトを保存して Anypoint Studio の埋め込みランタイムにデプロイします。
+
これでアプリケーションをデプロイする準備ができました。

== REST API の参照

HTTP 要求コネクタを使用する場合、RAML ファイルを参照できます。これにより、コネクタと残りのフローの設定が容易になります。コネクタは RAML ファイルを参照することで、RAML ファイルで説明されている使用可能なリソース、メソッド、およびパラメータに基づいて、スマートなオートコンプリートオプションを提供します。コネクタが公開するメタデータは、特に DataWeave Transform Message コンポーネントを利用することで、他の要素にマップしてフロー内の他の場所でその出力を参照する場合に役立ちます。

. HTTP 要求コネクタのプロパティエディタで、[Connector Configuration (コネクタ設定)] の横にある緑のプラス記号をクリックし、そのグローバル設定要素を作成します。
. [General (一般)] タブで、RAML の場所を指定します。ローカルシステムに保存されているファイルを参照するか、Exchange を使用して [Search RAML in Exchange (Exchange で RAML を検索)] をクリックし、RAML 定義をパブリッシュした公開 API のリストを参照できます。
. Exchange に移動して、接続する API を探します。[View Details (詳細を表示)] ボタンをクリックしてその API と RAML 定義の詳細を確認するか、[Add (追加)] をクリックして HTTP コネクタに参照させることができます。

=== ポータルの説明内の REST API

ポータルの説明から RAML ファイルまたは Swagger ファイルを参照する場合、[REST API Spec Version (REST API 仕様バージョン)] は使用中の RAML または Swagger のバージョン
(RAML の場合は 0.8 または 1、Swagger の場合は 1 または 2) であり、[API Version (APIバージョン)] はユーザの API のバージョンです。


== WSDL SOAP API の参照

Web サービスコンシューマを使用して、SOAP API 用の WSDL ファイルを参照できます。

WSDL ファイルコネクタは、WSDL ファイルで説明されている使用可能なリソース、メソッド、およびパラメータに基づいて、スマートなオートコンプリートオプションを提供します。コネクタが公開するメタデータは、特に DataWeave Transform Message コンポーネントを利用することで、他の要素にマップしてフロー内の他の場所でその出力を参照する場合に役立ちます。

SOAP WSDL を参照する手順は、次のとおりです。

. HTTP サービスコンシューマのプロパティエディタで、[Connector Configuration (コネクタ設定)] の横にある緑のプラス記号をクリックし、そのグローバル設定要素を作成します。
. Web サービスコンシューマの [Global Element Properties (グローバル要素のプロパティ)] メニューの [General (一般)] タブで、WSDL の場所を指定します。ローカルシステムに保存されているファイルを参照するか、Anypoint Exchange を使用して [Search WSDL in Exchange (Exchange で WSDL を検索)] をクリックし、WSDL 定義をパブリッシュした公開 API のリストを参照できます。
. Exchange に移動して、接続する API を探します。[View Details (詳細を表示)] ボタンをクリックしてその API と WSDL 定義の詳細を確認するか、[Add (追加)] をクリックして Web サービスコンシューマに参照させることができます。

== Exchange への非公開コンテンツの送信

Anypoint Platform アカウントがある場合、組織はそのサポート対象項目を Exchange で非公開で共有できます。[Login (ログイン)] をクリックして非公開の Exchange にアクセスできます。Exchange には、バージョンの互換性情報、ダウンロード可能なファイルや参考資料へのリンクと共に、共有する要素をカタログ化して説明できる検索可能なリポジトリがあります。

Exchange は非公開ファイルをホストすることはなく、そのリンクのみを使用します。つまり、Mule プロジェクトやコネクタを Exchange から簡単にダウンロードできるようにする場合、HTTP サービスを介して他の場所でそれらをホストする必要があります。または、Exchange 2 を使用して Exchange でファイルをホストできます。

== Exchange 権限の有効化

NOTE: この情報は従来の Exchange 1 にのみ適用され、現在の Exchange 2 バージョンには適用されません。

組織内のすべてのユーザは、Exchange でパブリッシュされている項目を参照できます。ただし、ユーザが組織の Exchange から要素を作成、パブリッシュ、更新、または削除するには、最初に組織内で適切な権限を付与されている必要があります。

デフォルトでは、Exchange コンテンツを送信する権限は誰にも付与されません。組織の管理者の場合、3 つのロールのいずれか 1 つにユーザを追加できます。

Anypoint Platform にログインしたら、左側のナビゲーションバーまたは Anypoint Platform の開始画面メニューから [Access Management (アクセス管理)] をクリックし、[Roles (ロール)] タブを選択します。さまざまなツールの一連のロールを含むテーブルが表示されますが、そのうち次の 3 つのみが Exchange 関連です。

* Exchange Viewers (Exchange 閲覧者) - Exchange アーティファクトを参照する。
* Exchange Contributors (Exchange コントリビュータ) - Exchange アーティファクトをコントリビュートする。
* Exchange Administrators (Exchange 管理者) - アーティファクトを Exchange でパブリッシュできるように、コントリビュータが作成した Exchange アーティファクトを承認する。

ユーザをロールに追加するには、ロールをクリックし、ユーザ名項目をクリックして名前を選択し、青いプラスボタンをクリックしてエントリを保存します。ユーザに Exchange の権限が割り当てられ、項目を送信できるようになります。

ヒント: Anypoint Platform でキーボードの Esc キーを押すと、左のナビゲーションバービューを開いたり閉じたりできます。

=== ロール別のコンテンツ状態の移行

どの時点でも、コンテンツは次の 3 つの状態のいずれかになります。

* Work in Progress (作業進行中): コントリビュータが作業を開始し、パブリッシュするために送信せずに保存している状態。
* Waiting for Approval (承認待機中): コントリビュータがコンテンツをパブリッシュするために送信し、承認者がまだパブリッシュしていない状態。
* Published (パブリッシュ済み): 管理者ロールのユーザがコンテンツを承認した状態。管理者が拒否した場合、コンテンツは承認待機中に戻ります。

Exchange コントリビュータが Exchange にコンテンツを送信したときに、そのコンテンツは作業進行中のままで、そのコントリビュータにのみ表示されます。コントリビュータはパブリッシュを要求することもできます。その場合にのみ管理者にそのコンテンツが表示され、管理者は要求をパブリッシュまたは拒否できます。

Exchange 管理者は独自のコンテンツや他のユーザのコンテンツを Exchange にパブリッシュできます。管理者は、パブリッシュ済みか承認待機中の他のユーザのコンテンツを参照、編集、または削除できます。

Exchange 閲覧者はコンテンツの参照のみ可能です。

== 非公開 Exchange への送信

Exchange にエントリを送信するには、左上にある [Add Item (項目を追加)] ボタンをクリックし、ドロップダウンリストから送信する項目の種別を選択します。項目の種別ごとに異なる項目が含まれた送信フォームが提供されます。

どの種別の Exchange エントリを作成する場合でも、説明を含めたり、YouTube 動画を埋め込んでエントリに関する詳細を提供したりできます。Exchange で見つけやすくするために、エントリに異なるタグを追加することもできます。

作成者名および対応する画像を含めて、必要に応じてコンテンツに表示することもできます。これは、組織に多数のコントリビュータとパートナーがいる場合に役立ちます。  このセクションは、入力されていない場合は非表示になります。

項目を送信すると、その項目は作業進行中の状況で Exchange に追加されるため、自分自身にのみ表示されます。Exchange 管理者ロールがある場合、[View Details (詳細を表示)] ボタンを使用して Exchange エントリを開き、[Publish (パブリッシュ)] ボタンをクリックすることで、簡単にパブリッシュできます。Exchange コントリビュータロールがある場合、パブリッシュを要求すると、Exchange 管理者ロールのユーザがそれを表示して承認できます。


== 監査ログ

監査ログは、Anypoint Exchange v1.7.0 以降のログ機能で、非公開 Exchange 管理者は Exchange 内のすべてのアクションのログを表示できます。ログに記録されたイベントには、項目の作成、追加、削除、パブリッシュ、編集など、基本的にユーザが Exchange を使用するときに発生するすべてのアクションが含まれます。

ログ内の情報は無期限に保持されます。

監査ログへのアクセスを有効にするには、各ユーザがExchange 管理者ロール、組織のシステム管理者ロールを持ち、非公開 Exchange 用に少なくとも 1 つの Exchange 項目が作成されている必要があります。

監査ログを有効にする手順は、次のとおりです。

. Anypoint Platform にログインします。
. [Access Management (アクセス管理)]、[Roles (ロール)] の順にクリックします。
. [Roles (ロール)] メニューで、ログを表示する必要がある各ユーザに対して [Exchange Administrator (Exchange 管理者)] および [Organization Administrator (組織のシステム管理者)] へのアクセス権を有効にします。
. 項目の追加、項目のパブリッシュなど、Exchange のアクティビティを実行します。これにより、アクティビティがログに記録されるため、それらのログを表示できます。
. [Access Management (アクセス管理)] > [Audit Logs (監査ログ)] をクリックします。
. [Products (商品)] をクリックして [Exchange] をクリックします。

ログを表示する手順は、次のとおりです。

. Anypoint Platform にログインし、[Access Management (アクセス管理)] > [Audit Logs (監査ログ)] をクリックします。
. Exchange リストの [Payload (ペイロード)] 列で、ダウンロードボタンをクリックします。ログのコピーが payload.txt ファイルに保存されます。
. テキストエディタまたはブラウザを使用して payload.txt ファイルを開きます。

== 非公開 Exchange へのテンプレートとサンプルの送信

テンプレートとサンプルは両方とも同じ方法で Exchange に送信されます。[Add Versions (バージョンを追加)] ボタンをクリックしてバージョン情報を入力した後に [Done (完了)] をクリックするだけで、異なる Mule Runtime バージョンで動作する複数のテンプレートバージョンを追加できます。追加する各バージョンには、Mule プロジェクト自体にリンクするための次の 3 つのオプションがあります。

* Download (ダウンロード): Mule のデプロイ可能な zip ファイルをホストする HTTP アドレスにリンク。組織の他のユーザには、Exchange エントリに [Download (ダウンロード)] ボタンが表示されます。これにより、ワンクリックでプロジェクトを Studio にインポートできます。
* Link (リンク): 外部アドレスにリンク。ファイルをダウンロードして Studio に手動でインポートできる場合があります。
* No link (リンクなし): リンクを指定しない。Exchange エントリには説明のみが含まれます。

Exchange を介してプロジェクトを Studio に自動的にインポートできるようにするには、プロジェクトを .zip ファイルにパッケージ化し、特定の方法で構造化する必要があります。

2015 年 1 月 - 更新サイト 1 バージョン以降の Anypoint Studio を使用している場合、プロジェクトのエクスポート時点で必要な構造の zip ファイルがすでに生成されています。Mule プロジェクトを Exchange に公開する手順は、次のとおりです。

* [File (ファイル)] > [Export (エクスポート)] を選択します。
* [Mule] > [Anypoint Studio Project to Mule Deployable Archive (includes Studio metadata) (Anypoint Studio プロジェクトから Mule のデプロイ可能なアーカイブへ (Studio メタデータを含む))] をクリックします。
* ウィザードの残りの手順に従い、エクスポートファイルの名前と場所を指定します。
 生成された .zip ファイルを HTTP サーバでホストします。
* サンプルまたはテンプレートを Exchange に送信し、バージョンを追加してその中でこの HTTP アドレスを参照します。

== 非公開 Exchange へのコネクタの送信

DevKit を使用して独自のカスタムコネクタを作成した場合は、それを組織内および Exchange 経由で共有できます。

[Add Versions (バージョンを追加)] ボタンをクリックしてバージョン情報を入力した後に [Done (完了)] をクリックするだけで、各 Mule Runtime バージョンに複数のコネクタバージョンを追加できます。

追加する各バージョンには、コネクタ自体にリンクするための次の 3 つのオプションがあります。

* Install (インストール): 機能 ID を参照。機能 ID はコネクタのダウンロード元となる更新サイトを示します。現在、公開コネクタの場合とは異なり、他のユーザは非公開でパブリッシュされたコネクタを直接ダウンロードすることはできません。この機能は将来提供される予定です。現時点では、コネクタをダウンロードできるアドレスにリンクする必要があります。
* Link (リンク): 外部アドレスにリンク。ファイルをダウンロードして Studio に手動でインポートできる場合があります。
* No link (リンクなし): リンクを指定しない。Exchange エントリには説明のみが含まれます。

各バージョンで個別に参照される、コネクタの各バージョンの特定のドキュメントにリンクすることもできます。

=== Anypoint Studio でのコネクタのインストール

. Anypoint Studio で Exchange 1 へのアクセスを有効にするため、Preferences (プリファレンス) > [Anypoint Studio] > [Exchange] をクリックし、[Exchange
Settings URL (Exchange 設定 URL)] の値を `+https://anypoint.mulesoft.com/exchange1/+` に設定します。
. Anypoint Studio の [Help (ヘルプ)] メニューで、[Install New Software (新しいソフトウェアをインストール)] をクリックします。
. [Work with (使用:)] 項目の横にある [Add (追加)] をクリックし、次の値を入力します。
.. Name (名前): パレットにコネクタを表示するための名前。
.. Location (場所): コネクタの update-site.zip ファイル (`target` フォルダ内) のファイルパスの先頭に `file:/` を追加。
. 検索条件項目の下のチェックボックス (下の画像を参照) で、コネクタを選択します。フォルダをクリックして展開し、個々の項目を選択して [Next (次へ)] をクリックします。
. 選択した項目の詳細を確認してから、[Next (次へ)] をクリックします。
. クリックして商品の契約条件に同意し、[Finish (完了)] をクリックします。
. [Restart Now (今すぐ再起動)] をクリックしてインストールを完了します。
. Studio が再起動したら、パレットで新しい Hello コネクタを検索します。


=== REST API

API を説明する RAML 定義ファイルがある場合、または API を対話形式でドキュメント化する API Portal がある場合は、Exchange を使用してそれらを組織内の他のユーザに公開できます。組織内の誰かが Anypoint Studio の HTTP 要求コネクタを介して API に接続する場合、API の RAML ファイルを参照すると API のメタデータが公開され、インテグレーションが非常に簡単になります。API が API Manager に登録されている場合、Exchange からそのポータルにリンクすることもできます。これにより、内部ユーザのエンゲージメントを容易にするための汎用性が高いインタラクティブツールを提供できます。

Exchange エントリに複数の API バージョンを追加するには、[Add Versions (バージョンを追加)] ボタンをクリックしてバージョン情報を入力した後に [Done (完了)] をクリックするだけです。追加する各バージョンに次の情報も含めます。

* API の RAML 定義ファイルへのリンク。
* API Manager にある API のポータルへのリンク。

=== SOAP API

API を説明する WSDL 定義ファイルがある場合、Exchange を使用してそれを組織内の他のユーザに公開できます。組織内の誰かが Anypoint Studio の Web サービスコンシューマを介して API に接続する場合、API の WSDL ファイルを参照すると API のメタデータが公開され、インテグレーションが非常に簡単になります。

Web サービスコンシューマコネクタを介して統合する場合、特定の WSDL の場所を指定するか、[Search WSDL in Exchange (Exchange で WSDL を検索]
リンクをクリックして Anypoint Exchange でパブリッシュ済みの WSDL のリストを表示できます。

Exchange エントリに複数の API バージョンを追加するには、[Add Versions (バージョンを追加)] ボタンをクリックしてバージョン情報を入力した後に [Done (完了)] をクリックするだけです。追加する各バージョンで、API の WSDL 定義ファイルへのリンクも含めます。

== Studio での非公開 Exchange コネクタのインストール

Anypoint Exchange 1.7.0 以降では、コネクタを Anypoint Studio で作成し、Exchange にリストし、Studio にインストールできます。この機能により、MuleSoft が Exchange を使用してコネクタをインストールするのと同じ方法で、組織は非公開 Exchange を使用して Studio にコネクタをインストールできます。組織は非公開 Exchange を使用して、内部サービス用に作成したコネクタをリストし、非公開 Exchange ユーザが詳細を表示して Studio アプリケーションで使用するコネクタをインストールできるようにします。

この機能を使用する手順は、次のとおりです。

. Maven および Anypoint Connector DevKit Plugin をダウンロードしてインストールします。詳細は、「Anypoint Connector DevKit」を参照してください。
. 新しい Anypoint コネクタプロジェクトを作成します。必要に応じて、プロジェクトに追加します。
. Studio を使用して、コネクタを zip ファイルとしてエクスポートします。Package Explorer でプロジェクト名を右クリックし、[Export (エクスポート)] > [Mule] > [Anypoint Connector Update Site (Anypoint コネクタ更新サイト)]、[Next (次へ)] の順にクリックして zip ファイルを保存するパスを指定し、[Finish (完了)] をクリックします。
. zip ファイルを開きます。テキストエディタで `content.xml` ファイルを開き、`id=` 値に続いて `version=` 値を検索します。次の例では、最後の行に id が `org.mule.tooling.ui.extension.my-connector.3.5.0.feature.group`、version が `version='1.0.0.201607271521'` と示されています。この ID 文字列は、この後に参照する機能 ID です。機能 ID は常に `org.mule.tooling.ui.extension.{anything}.feature.group` のようになります。
+
[source,text,linenums]
----
<?xml version='1.0' encoding='UTF-8'?>
<?metadataRepository version='1.1.0'?>
<repository name='file:/Users/me/AnypointStudio/workspace/my-connector/target/update-site/ - metadata' type='org.eclipse.equinox.internal.p2.metadata.repository.LocalMetadataRepository' version='1.0.0'>
  <properties size='2'>
  ...
  </properties>
  <units size='4'>
    <unit
    ...
    </unit>
    <unit id='org.mule.tooling.ui.extension.my-connector.3.5.0.feature.group' version='1.0.0.201607271521' singleton='false'>
----
+
. Anypoint Exchange で、[Add item (項目を追加)] > [Connector (コネクタ)] をクリックします。コネクタに関する情報を入力します。下にスクロールして [Add version (バージョンを追加)] をクリックします。
. [Versions (バージョン)] メニューで、[Connector Version (コネクタバージョン)] 項目にバージョン文字列 (前の例では `1.0.0.201607271521`)、[Feature ID (機能 ID)] 項目に機能 ID 文字列 (前の例では `org.mule.tooling.ui.extension.my-connector.3.5.0.feature.group`) を入力します。この例では、完了した項目は次のようになります。
+
** Connector Version (コネクタバージョン): `1.0.0.201607271521`
** Runtime Version (ランタイムバージョン): `3.8`
** Notes (メモ): `Dept Status`
** [Install (インストール)] ラジオボタンがオン
** Update Site URL (更新サイト URL): `+http://department-status-connector.example.com+`
** Feature ID (機能 ID): `1.0.0.201607271521`
** Documentation URL (ドキュメント URL): `+http://department-status-connector.example.com/getting-started+`
+
. コネクタの zip ファイルを含むリポジトリへのリンクを指定します。注意: コネクタを提供するリポジトリは、アクセスするための基本認証をサポートしている必要があります。MuleSoft は Sonatype Nexus リポジトリを使用してこの機能をテストしていますが、基本認証をサポートする他のリポジトリも使用できる可能性があります。
. 必要に応じて、コネクタのドキュメントへのリンクを指定します。
. [Done (完了)] をクリックしますExchange によって、指定した機能 ID から実際のコネクタバージョンが解決されます。
. 上にスクロールして [Save new item (新しい項目を保存)] をクリックします。
. [Publish (パブリッシュ)] をクリックし、コネクタ項目をユーザが使用できるようにします。
. Anypoint Studio に移動し、Exchange アイコンをクリックして新しいコネクタを見つけ、コネクタをテストします。コネクタをインストールします。

== 非公開 Exchange のビジネスグループ

Anypoint Exchange では、組織のロールに応じてユーザが参照可能な Exchange アーティファクトを決定できるビジネスグループがサポートされています。Exchange には、[Show content from (コンテンツの表示元)] および [Scope (スコープ)] の検索条件があり、ビジネスグループでコンテンツを絞り込むことができます。

ビジネスグループを表示する手順は、次のとおりです。

. Anypoint Platform にログインします。
. 上部のタスクバーで組織の名前をクリックし、現在のビジネスグループを表示します。
+
image::ex1-exchange-view-business-groups.png[Exchange 1 のタスクバーにある [Business Groups (ビジネスグループ)] ドロップダウンのスクリーンショット]

Exchange のビジネスグループ機能では、組織内のユーザにどのロールを割り当てるかに応じて、パブリッシュ済みのコンテンツがビジネスグループを使用して共有されます。

ビジネスグループで次が可能になります。

* アーティファクト作成し、下位組織であるすべての事業部門が使用できるようにするルート組織などの中央 IT 組織。
* ビジネスグループでパブリッシュされたアーティファクトを見つけて、他のビジネスで使用できるようにする中央 IT 組織。
* そのビジネスグループがコンシュームする内部のアーティファクトをパブリッシュする事業部門。

image::ex1-exchange-bgroups.png[ビジネスグループのコンシューム図]

管理者がビジネスグループをユーザに割り当てるため、ユーザは特定のビジネスグループにのみ属します。ユーザが権限を持たない BG1.1 に招待された場合、そのビジネスグループのアーティファクトは参照できません。

組織に属するユーザは、その組織 (最上位組織) のアーティファクトを参照できます。そのため、「org 1」のメンバーであり、何の権限も持たないユーザは、org 1 でパブリッシュ済みのアーティファクトのみを参照できます。

このユーザのナビゲーションバーのドロップダウンには、Org1 オプションのみが表示されます。

Exchange ロールは割り当てられておらず、API 作成者 (アーティファクトの参照) などの他のロールが割り当てられているユーザが BG 1.1 に招待された場合、そのユーザには 1.1 が表示されます

=== 閲覧者のアーティファクトの参照

閲覧者ロールを持つユーザが BG 1.1 に招待された場合、ユーザには Org1 および BG 1.1 に属するパブリッシュ済みのアーティファクトが表示されます。
このユーザのナビゲーションバーには、BG 1.1 オプションのみが表示されます。

=== コントリビュータのアーティファクトの参照

コントリビュータが BG 1.1 に属する場合、BG 1.1、BG 1、および Org 1 に属するアーティファクトが表示されます。

ここで、このユーザが BG 1.1 と BG 2 の両方に属しているとします。その場合、ユーザには BG 2 および Org 1 に属するアーティファクトが表示されます。

したがって、コントリビュータは階層の上位のアーティファクトを参照できます。

また、コントリビュータは自分が属するビジネスグループにのみアーティファクトをコントリビュートできます。

Exchange の [Show content from (コンテンツの表示元)] には、このロジックに基づくビジネスグループのみが表示されます。ユーザは常に MuleSoft にアクセスできます。

=== 承認者のアーティファクトの参照

ユーザが承認者権限を持ち、BG1 に属しているとします。承認者は、自分が属するビジネスグループ、またはそのビジネスグループの子であるビジネスグループに属するアーティファクトのみを承認できます。そのためこの場合は、承認者には BG 1、BG 1.1、および BG 1.2 の項目のみが表示されます。

承認者には、パブリッシュ済みのアーティファクトとパブリッシュ待機中のアーティファクトの両方が表示されます。承認者は、パブリッシュ待機中のアーティファクトを任意の組織に自由にパブリッシュできます。すでにパブリッシュ済みのアーティファクトを別の組織に再パブリッシュすることもできます。

承認者にはコントリビュータ権限もあるため、承認者は BG1 と Org1 の項目を参照できます。ただし、承認者は Org 1 の項目を承認できません。

=== Exchange の検索条件

2016 年 5 月以降の Anypoint Exchange では、コンテンツを検索するための新しい検索条件がサポートされています。

* [`Show content from` (コンテンツの表示元)] 検索条件
* [`Scope` (スコープ)] 検索条件 - ナビゲーションバーで選択されている組織内でのユーザのロールによって異なる。

デフォルトでリストに表示されるコンテンツは、ナビゲーションバーで選択されている組織またはビジネスグループによって異なります。

== 関連情報

* xref:release-notes::exchange/exchange-on-prem-release-notes.adoc[Anypoint Exchange Private Cloud Edition リリースノート]。
* xref:exchange1-faq.adoc[Exchange1 FAQ]。
* https://www.mulesoft.com/resources/esb/top-five-data-integration-patterns[インテグレーションパターン]。
* アプリケーションのさまざまなxref:runtime-manager::deployment-strategies.adoc[デプロイ]方法について学習する。
* Salesforce を中心としたテンプレート関する http://blogs.mulesoft.com/dev/mule-dev/anypoint-templates-database-intro/[ブログ投稿]と http://blogs.mulesoft.com/dev/mule-dev/connected-company-part-1-salesforce-integration-templates/[別の投稿]を読む。
